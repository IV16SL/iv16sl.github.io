<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>为Windows 11配置DOH(DNS Over Https)</title>
    <url>/posts/58192ec3/</url>
    <content><![CDATA[<p>Windows 11在22000.51这个版本开始支持DND Over Https(下文简称DOH)，在此之前已经有不少浏览器已经支持DOH，例如Google Chrome和Mozilla Firefox。</p>
<p>DOH的出现意味着DNS客户端和DNS服务器之间的查询将通过安全的https连接而不再是纯文本，不论隐私还是安全都能够获得有效的提升，尽管这些在当下互联网中都是相对的。</p>
<span id="more"></span>

<h1 id="Windows-11内置的支持DOH的DNS"><a href="#Windows-11内置的支持DOH的DNS" class="headerlink" title="Windows 11内置的支持DOH的DNS"></a>Windows 11内置的支持DOH的DNS</h1><p>为Windows 11配置DOH并不复杂，但是默认情况下，你只能选择内置的DNS服务商；</p>
<p>你可以使用下面这个Powershell命令来列出系统当前内置的DNS服务商：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Get-DNSClientDohServerAddress</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ServerAddress        AllowFallbackToUdp AutoUpgrade DohTemplate</span><br><span class="line">-------------        ------------------ ----------- -----------</span><br><span class="line">149.112.112.112      False              False       https://dns.quad9.net/dns-query</span><br><span class="line">9.9.9.9              False              False       https://dns.quad9.net/dns-query</span><br><span class="line">8.8.8.8              False              False       https://dns.google/dns-query</span><br><span class="line">8.8.4.4              False              False       https://dns.google/dns-query</span><br><span class="line">1.1.1.1              False              False       https://cloudflare-dns.com/dns-query</span><br><span class="line">1.0.0.1              False              False       https://cloudflare-dns.com/dns-query</span><br><span class="line">2001:4860:4860::8844 False              False       https://dns.google/dns-query</span><br><span class="line">2001:4860:4860::8888 False              False       https://dns.google/dns-query</span><br><span class="line">2606:4700:4700::1001 False              False       https://cloudflare-dns.com/dns-query</span><br><span class="line">2606:4700:4700::1111 False              False       https://cloudflare-dns.com/dns-query</span><br><span class="line">2620:fe::fe          False              False       https://dns.quad9.net/dns-query</span><br><span class="line">2620:fe::fe:9        False              False       https://dns.quad9.net/dns-query</span><br></pre></td></tr></table></figure>

<h1 id="添加自定义DNS"><a href="#添加自定义DNS" class="headerlink" title="添加自定义DNS"></a>添加自定义DNS</h1><p>如果你希望使用的DNS并不在此列表中，你也可以通过下面的Powershell命令来添加你自己喜欢的DNS；</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Add-DnsClientDohServerAddress</span> <span class="literal">-ServerAddress</span> <span class="string">&#x27;&lt;resolver-IP-address&gt;&#x27;</span> <span class="literal">-DohTemplate</span> <span class="string">&#x27;&lt;resolver-DoH-template&gt;&#x27;</span> <span class="literal">-AllowFallbackToUdp</span> <span class="variable">$False</span> <span class="literal">-AutoUpgrade</span> <span class="variable">$True</span></span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Add-DnsClientDohServerAddress</span> <span class="literal">-ServerAddress</span> <span class="string">&#x27;223.5.5.5&#x27;</span> <span class="literal">-DohTemplate</span> <span class="string">&#x27;https://dns.alidns.com/dns-query&#x27;</span> <span class="literal">-AllowFallbackToUdp</span> <span class="variable">$False</span> <span class="literal">-AutoUpgrade</span> <span class="variable">$True</span></span><br></pre></td></tr></table></figure>

<h1 id="为当前网络设置DOH"><a href="#为当前网络设置DOH" class="headerlink" title="为当前网络设置DOH"></a>为当前网络设置DOH</h1><ul>
<li>“Windows 11设置”，选择”网络和Internet”；</li>
<li>选择”以太网”，编辑”DNS服务器分配”；</li>
<li>编辑DNS设置为手动，键入你的DNS IP地址；</li>
<li>将首选的DNS加密设置为”仅加密(通过HTTPS的DNS)”，保存。</li>
</ul>
<p>以上设定也将作用于你的WLAN或者Wi-Fi网络。</p>
<h1 id="三种模式的区别"><a href="#三种模式的区别" class="headerlink" title="三种模式的区别"></a>三种模式的区别</h1><p><strong>仅未加密</strong>：默认选项，到指定DNS服务器的查询全部未加密，通过传统的纯文本查询；</p>
<p><strong>仅加密（通过HTTPS的DNS）</strong>：所有DNS查询将通过HTTPS传输来获得最有效的保护，但是如果指定DNS服务器如果不支持DOH查询，则不会进行DNS解析；</p>
<p><strong>已加密的首选，未加密的允许</strong>：将邮箱尝试通过DOH查询，如果目标DNS服务器不支持DNS则改为纯文本查询以获得最佳兼容性。</p>
]]></content>
      <categories>
        <category>折腾</category>
      </categories>
      <tags>
        <tag>Windows 11</tag>
        <tag>DNS</tag>
        <tag>DOH</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/4a17b156/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Vaultwarden/Bitwardenrs启用两步验证和QQ邮箱代发验证码</title>
    <url>/posts/c7341afb/</url>
    <content><![CDATA[<p>在使用密码托管服务时，我最初只需要简单的同步，能够供手机使用即可。所以在使用1Password的时候，一直使用的是单机版。随着时间的推移，自己也有多平台需要，这种方式渐渐变的不方便，由于不太想使用1Password的网络服务，在前个月把密码托管逐步迁移到了自建Bitwarden服务。经过将近2个月的使用，个人感受相当良好。虽然有些小问题，但都在可以接受的范围内。</p>
<p>因为有多平台和外网需要，所以便开放了外网，因为安全考虑设置了2步验证并且关闭注册，本文主要说一下开放2步验证以及备用手段即QQ邮箱接收验证码。</p>
<span id="more"></span>

<h1 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h1><p>我的Bitwarden服务通过Docker搭建在群晖上，虽然这样做有人觉得会存在不少问题，但我觉得人数不多且做好安全措施的话，可以接受这种方法。</p>
<h1 id="设置两步验证"><a href="#设置两步验证" class="headerlink" title="设置两步验证"></a>设置两步验证</h1><ul>
<li><p>登录你的Bitwarden密码库网页后台；</p>
</li>
<li><p>点击右上角头像→我的账户→两部登录；</p>
</li>
<li><p>点击管理验证器应用，准备好Google Authenticator或者Microsoft Authenticator，根据自己的喜好来；</p>
</li>
<li><p>使用验证器扫描二维码→填入6位验证码→确定以及保存好恢复代码；</p>
<blockquote>
<p>Bitwarden的恢复代码在设置里可以再次查看，请妥善保管。</p>
</blockquote>
</li>
</ul>
<h1 id="设置邮箱服务以及代发验证码"><a href="#设置邮箱服务以及代发验证码" class="headerlink" title="设置邮箱服务以及代发验证码"></a>设置邮箱服务以及代发验证码</h1><p>我一开始觉得单纯的验证器已经够用，但是我遇到了TOTP服务器时间不正确的问题，一旦客户端和服务端时间差异超过1分钟，你的请求就是被服务端拒绝。保险起见我又多设置了邮箱服务，邮件验证码的有效期10分钟，是个很好的备选方案。</p>
<p>通过域名加上”&#x2F;admin”访问Bitwarden的管理后台，输入admin token登录；</p>
<blockquote>
<p>Admin token在Dockers面板里设置，增加一条环境变量”ADMIN_TOKEN&#x3D;xxx”,xxx表示任意长度字符串，别太短就好，后期长时间不用就把这条删掉以保证安全性。</p>
</blockquote>
<p>点击”SMTP Email Settings”,进行如下设置：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enable: true</span><br><span class="line">Host: smtp.qq.com</span><br><span class="line">Enable Secure SMTP :true</span><br><span class="line">Force TLS :true</span><br><span class="line">Port :465</span><br><span class="line">From Address :user@qq.com #user就是你的用户名,这里不要用不是当前账户的地址，否则可能发送失败</span><br><span class="line">From Name :Bitwarden</span><br><span class="line">Username :user@qq.com #user就是你的用户名</span><br><span class="line">Password :yourpassword #登录QQ邮箱Web页面，账户POP3设置里面生成授权码，需要关闭安全登录才会显示此选项</span><br><span class="line">SMTP Auth mechanism :Plain</span><br><span class="line">SMTP connection timeout :15</span><br></pre></td></tr></table></figure>

<p>随后可以测试发送邮件是否成功，并且回到Bitwarden密码库网络后台的两部登陆中开启电子邮件验证码功能。</p>
<h1 id="TOTP服务端时间不同步"><a href="#TOTP服务端时间不同步" class="headerlink" title="TOTP服务端时间不同步"></a>TOTP服务端时间不同步</h1><p>我也不知道为何会产生此问题，我最后把群晖的NTP服务器改成了”time.nist.gov”，之后一段时间都暂未遇到此问题。</p>
]]></content>
      <categories>
        <category>折腾</category>
      </categories>
      <tags>
        <tag>Bitwarden</tag>
        <tag>QQ邮箱</tag>
        <tag>两部验证</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 11使用笔记、疑难杂症</title>
    <url>/posts/c7f49c9e/</url>
    <content><![CDATA[<p>博主在近日将自己的两台电脑分别升级到了Windows 11，本文将会是一个长期使用笔记以及所遭遇的疑难杂症解决方案等。操作系统产品的使用具有一定时效性，本文尽量保证及时更新。</p>
<span id="more"></span>

<h1 id="升级方式"><a href="#升级方式" class="headerlink" title="升级方式"></a>升级方式</h1><p>升级方式一般以下四种：</p>
<ul>
<li><p>全新安装，通过镜像、启动U盘等，都属于这一类；</p>
</li>
<li><p>Windows 10用户等待微软推送；</p>
<blockquote>
<p>版本必须为2004或者更高；</p>
</blockquote>
</li>
<li><p>使用<a href="https://www.microsoft.com/zh-cn/software-download/windows11">Windows 11安装助手</a>进行升级；</p>
</li>
<li><p>购买预装Windows 11的电脑。</p>
</li>
</ul>
<h1 id="疑难杂症"><a href="#疑难杂症" class="headerlink" title="疑难杂症"></a>疑难杂症</h1><h4 id="更新至Windows-11后，进入桌面就开始不停闪屏"><a href="#更新至Windows-11后，进入桌面就开始不停闪屏" class="headerlink" title="更新至Windows 11后，进入桌面就开始不停闪屏"></a>更新至Windows 11后，进入桌面就开始不停闪屏</h4><p>这种情况一般出现于由Win10直接升级至Win11进入桌面后出现，没有开始菜单，桌面不停刷新。解决此问题的方法为，使用快捷键”Ctrl+Shift+Esc”调出任务管理器，点击”文件”→”运行新任务”→输入”Control”并回车调出控制面板，点击”区域和时间”→”更改时区”→下拉菜单点击一下，确定即可。</p>
<p>导致此问题的原因尚不明确。</p>
]]></content>
      <categories>
        <category>折腾</category>
      </categories>
      <tags>
        <tag>Windows 11</tag>
        <tag>微软</tag>
        <tag>疑难杂症</tag>
      </tags>
  </entry>
</search>
